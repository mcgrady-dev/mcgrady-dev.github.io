反射式编程是指程序在运行时可以访问、检查和修改它自身的状态或行为的一种能力。通俗来讲，反射机制可以构造任意一个类的对象，可以了解任意一个对象所属的类，可以了解任意一个类的成员变量和方法，可以调用任意一个对象的属性和方法。

<!--more-->



## Reflection

反射式编程是指程序在运行时可以访问、检查和修改它自身的状态或行为的一种能力。通俗来讲，反射机制可以构造任意一个类的对象，可以了解任意一个对象所属的类，可以了解任意一个类的成员变量和方法，可以调用任意一个对象的属性和方法。

反射只要用途是给程序动态地适应不同的运行情况。

尽管Java不是动态语言，但却有着一个非常突出的动态相关的反射机制。



### 反射的特点

尽管反射机制带来了极大的灵活性及方便性，但反射也有缺点。反射机制的功能非常强大，但不能滥用。在能不使用反射完成时，尽量不要使用，原因有以下几点：

1. **性能问题**
   Java反射机制中包含了一些动态类型，所以Java虚拟机不能够对这些动态代码进行优化。因此，反射操作的效率要比正常操作效率低很多。我们应该避免在对性能要求很高的程序或经常被执行的代码中使用反射。而且，如何使用反射决定了性能的高低。如果它作为程序中较少运行的部分，性能将不会成为一个问题。
2. **安全限制**
   使用反射通常需要程序的运行没有安全方面的限制。如果一个程序对安全性提出要求，则最好不要使用反射。
3. **程序健壮性**
   反射允许代码执行一些通常不被允许的操作，所以使用反射有可能会导致意想不到的后果。反射代码破坏了Java程序结构的抽象性，所以当程序运行的平台发生变化的时候，由于抽象的逻辑结构不能被识别，代码产生的效果与之前会产生差异。

### 为什么要用反射

正如《人月神话》一书所言：软件工程没有银弹，很多架构，尤其是三方框架，无法保证自己的封装是完美的。有了反射这一后门，为程序设计提供更大的灵活性。工具本身没有错，关键在于如何正确使用。

反射主要应用在以下几个方面：

- 反射可以通过外部类的全路径名创建对象，并使用这些类，实现一些扩展的方功能；
- 反射可以枚举出类的全部成员，包括构造函数、属性、方法，以帮助开发者写出正确的代码；
- 测试时可以利用反射API访问类的私有成员，以保证测试代码覆盖率；



## 反射API

### Class类

Class类是一个比较特殊的类，它是反射机制的基础，Class类的对象表示正在运行的Java程序中的类或接口，也就是任何一个类被加载时，即将类的`.class`文件（字节码文件）读入内存的同时，都自动为之创建一个`java.lang.Class`对象。Class类没有公共构造方法，其对象是JVM在加载类时通过调用类加载器中的`defineClass()`方法创建的，因此不能显式地创建一个Class对象。通过这个Class对象，才可以获得该对象的其他信息。





